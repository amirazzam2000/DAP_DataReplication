<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>web socket interface</title>
    <script src="../websocket.js"></script>

</head>
<body>

<script>
    var a=self.setInterval(function(){
        window.table = (
            (document.cookie.match('(^|;)\\s*' + "table" +
                '\\s*=\\s*([^;]+)')?.pop() || '')
        ).split(/\r?\n|\r/);

        console.log("reading cookie ");
        console.log(window.table);

        //updateValues();
        fetch('../array_values.csv')
            .then(response => response.text())
            .then(data => {
                aux = data.split(/\r?\n|\r/);

                console.log("data value: " + data);
                console.log("updating!");
                if(aux!= null){
                    window.table = aux;

                    for ( let i = 0 ; i < aux.length-1; i++ ){
                        document.cookie = "N" + i + "=" + aux[i];
                    }
                    window.location.reload();
                }
            });
    }, 1000);
</script>
<div style="
    display: flex;
    flex-direction: row;">

    <div style="border: solid; margin: 30px; padding: 10px; ">
        <h1 style="margin: 2px">Core Layer</h1>
        <div style="margin: 7px">
            <h2> Node A1</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N0"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"A1_" + a +
                                ">"+ rowCells[a] +"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

        <div style="margin: 7px">
            <h2> Node A2</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N1"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"A2_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

        <div style="margin: 7px">
            <h2> Node A3</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N2"
                         var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"A3_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

    </div>
    <div style="border: solid; margin: 30px; padding: 10px; ">
        <h1 style="margin: 2px">Layer 1</h1>
        <div style="margin: 7px">
            <h2> Node B1</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N3"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"B1_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

        <div style="margin: 7px">
            <h2> Node B2</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N4"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"B2_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

    </div>
    <div style="border: solid; margin: 30px; padding: 10px; ">
        <h1 style="margin: 2px">Layer 2</h1>
        <div style="margin: 7px">
            <h2> Node C1</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N5"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"C1_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

        <div style="margin: 7px">
            <h2> Node C2</h2>
            <table style="border: solid">
                <tr>
                    <script type="text/javascript">
                        var fetchVal = "N6"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        console.log(rowCells)
                        for (var a=0; a < 10; a++) {
                            document.write(
                                "<td style=\"" +
                                "border: solid; " +
                                "padding: 5px"+
                                "\" id=" +"C2_" + a +
                                ">"+0+"</td>");
                        }
                    </script>
                </tr>
            </table>
        </div>

    </div>
    <div style="border: solid; margin: 30px; padding: 10px; ">
        <h1 style="margin: 2px">Client Reads</h1>
        <div style="display: flex; flex-direction: row">
            <div style="margin: 7px; border: solid; padding: 10px">
                <h2> Request </h2>

                <div>
                    <h3   style="display:inline;"> Layer : </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_R_Layer_Id\" style=\"padding-right:  3px\">" +
                            rowCells[0] +
                            "</label>"
                        );
                    </script>

                </div>

                <br>

                <div>
                    <h3 style="display:inline;"> Node :  </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_R_Node_Id\" style=\"padding-right:  3px\">" +
                            rowCells[1] +
                            "</label>"
                        );
                    </script>
                </div>

                <br>

                <div>
                    <h3 style="display:inline;"> Position : </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_R_pos_Id\" style=\"padding-right:  3px\">" +
                            rowCells[2] +
                            "</label>"
                        );
                    </script>
                </div>


            </div>

            <div style="margin: 7px; border:solid; padding:10px ">
                <h2> Answer </h2>
                <div>
                    <h3 style="display:inline;"> Layer : </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_A_value\" style=\"padding-right:  3px\">" +
                            rowCells[6] +
                            "</label>"
                        );
                    </script>
                </div>

                <br>

                <div>
                    <h3 style="display:inline;"> Node : </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_A_Node_Id\" style=\"padding-right:  3px\">" +
                            rowCells[3] +
                            "</label>"
                        );
                    </script>
                </div>

                <br>

                <div>
                    <h3 style="display:inline;">  Position: </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_A_pos\" style=\"padding-right:  3px\">" +
                            rowCells[4] +
                            "</label>"
                        );
                    </script>
                </div>

                <br>

                <div>
                    <h3 style="display:inline;"> Value : </h3>
                    <script>
                        var fetchVal = "N7"
                        var table = (
                            (document.cookie.match('(^|;)\\s*' + fetchVal+
                                '\\s*=\\s*([^;]+)')?.pop() || '')
                        ).split(/\r?\n|\r/);
                        var rowCells = table[0].split(',');
                        document.write(
                            "<label id=\"Client_A_value\" style=\"padding-right:  3px\">" +
                            rowCells[5] +
                            "</label>"
                        );
                    </script>
                </div>

            </div>
        </div>


    </div>
</div>

</body>
</html>